<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mission: BrÃ¼che</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#121212">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <style>
        /* --- GAMING THEME COLORS --- */
        :root {
            --bg-dark: #121212;
            --card-bg: rgba(30, 30, 30, 0.95);
            --text-main: #ffffff;
            --accent: #3498db;  /* Challenger Blau */
            --success: #27ae60; /* Rookie GrÃ¼n */
        }

        body {
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            margin: 0; padding: 20px; color: var(--text-main);
            background-color: var(--bg-dark); /* Fester dunkler Hintergrund */
            padding-bottom: 100px;
            overflow-x: hidden; /* Verhindert seitliches Scrollen durch Animation */
        }

        /* --- NEUE HINTERGRUND ANIMATION (Geometrie) --- */
        .bg-animation {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1; /* Hinter dem Inhalt */
            overflow: hidden;
            pointer-events: none; /* Klicks gehen durch */
        }

        .shape {
            position: absolute;
            opacity: 0.15; /* Sehr dezent */
            filter: blur(8px); /* Weicher Look */
            animation: float 25s infinite linear;
        }

        /* Verschiedene Formen */
        .s1 { top: 10%; left: 5%; width: 150px; height: 150px; background: var(--accent); border-radius: 20px; animation-duration: 35s; }
        .s2 { top: 70%; left: 80%; width: 200px; height: 200px; background: var(--success); border-radius: 50%; animation-delay: -5s; }
        .s3 { top: 40%; left: 60%; width: 100px; height: 100px; background: var(--accent); transform: rotate(45deg); animation-duration: 45s; animation-delay: -10s;}
        .s4 { top: 80%; left: 10%; width: 120px; height: 120px; border: 5px solid var(--success); animation-duration: 30s; animation-delay: -15s;}

        @keyframes float {
            0% { transform: translateY(0) rotate(0deg) scale(1); }
            50% { transform: translateY(-100px) rotate(180deg) scale(1.1); }
            100% { transform: translateY(0) rotate(360deg) scale(1); }
        }

        .container { max-width: 700px; margin: 0 auto; position: relative; z-index: 2; }

        /* HEADER */
        header { text-align: center; margin-bottom: 40px; }
        h1 { margin: 0; text-transform: uppercase; letter-spacing: 2px; font-size: 1.5em; color: var(--accent); text-shadow: 0 0 10px rgba(52, 152, 219, 0.3); }
        .subtitle { color: #888; font-size: 0.9em; margin-top: 5px; }

        /* BRUCH-DARSTELLUNG */
        .frac { display: inline-block; text-align: center; vertical-align: middle; position: relative; top: -5px; font-size: 0.9em; padding: 0 4px; }
        .frac .top { display: block; border-bottom: 1px solid rgba(255,255,255,0.7); padding: 0 2px; }
        .frac .bottom { display: block; padding: 0 2px; }
        .mixed { font-size: 1.2em; margin-right: 4px; font-weight: bold; }

        /* SEKTIONEN */
        .section-title { 
            margin-top: 50px; margin-bottom: 20px; 
            font-size: 1em; color: var(--accent); font-weight: bold; text-transform: uppercase; letter-spacing: 1px;
            border-bottom: 1px solid #333; padding-bottom: 5px;
        }

        /* FRAGEN-KARTEN (Jetzt undurchsichtiger damit man besser liest) */
        .question-block { 
            background: var(--card-bg);
            padding: 20px; 
            border-radius: 15px; 
            margin-bottom: 25px; 
            border: 1px solid #333;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        .q-text { font-weight: 500; font-size: 1.1em; display: block; margin-bottom: 20px; }

        /* RADIO BUTTONS */
        .options-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; } 
        @media(max-width: 500px) { .options-grid { grid-template-columns: 1fr; } }

        .radio-label { 
            display: flex; align-items: center; padding: 15px; 
            background: #2a2a2a; border: 1px solid #444; border-radius: 10px; 
            cursor: pointer; transition: all 0.2s; 
        }
        .radio-label:hover { background: #333; border-color: var(--accent); }
        .radio-label:has(input:checked) { background: rgba(52, 152, 219, 0.2); border-color: var(--accent); }
        .radio-label input { margin-right: 12px; accent-color: var(--accent); transform: scale(1.2); }

        /* INPUTS */
        input[type="text"], select { 
            width: 100%; padding: 15px; 
            background: #222; border: 1px solid #444; color: white;
            border-radius: 8px; font-size: 16px; box-sizing: border-box; 
        }
        input:focus { outline: none; border-color: var(--accent); }

        /* BUTTON */
        button { 
            display: block; width: 100%; padding: 20px; margin-top: 50px; 
            background: var(--success); color: white; border: none; border-radius: 12px; 
            font-size: 1.2em; font-weight: bold; cursor: pointer; 
            box-shadow: 0 0 20px rgba(39, 174, 96, 0.4); 
            transition: transform 0.1s;
        }
        button:hover { background: #2ecc71; transform: scale(1.02); }
        button:active { transform: scale(0.98); }
        button:disabled { background: #555; box-shadow: none; cursor: wait; }

    </style>
</head>
<body>

<div class="bg-animation">
    <div class="shape s1"></div>
    <div class="shape s2"></div>
    <div class="shape s3"></div>
    <div class="shape s4"></div>
</div>

<div class="container">
    <header>
        <h1>Mission: BrÃ¼che</h1>
        <div class="subtitle">Diagnose-Protokoll v1.1</div>
    </header>

    <form id="quizForm" action="https://mathemeister.app.n8n.cloud/webhook/8b5a6681-d702-428b-9325-c9b803e69fba" method="POST">
        
        <input type="hidden" name="00_SCORE" id="scoreInput" value="">
        <input type="hidden" name="00_DAUER" id="durationInput" value="">
        <input type="hidden" name="Rohdaten" id="rawInput" value="">
        <input type="hidden" name="Thema" value="Brueche_Terme">
        
        <div id="welcomeMessage" style="display:none; background:rgba(39, 174, 96, 0.2); color:#2ecc71; padding:15px; border-radius:10px; margin-bottom:25px; border: 1px solid #27ae60; text-align:center;">
            ðŸ‘‹ Pilot <strong id="displayName">...</strong> erkannt.
            <br><small onclick="resetUser()" style="cursor:pointer; text-decoration:underline; font-size:0.8em; color:#aaa; display:block; margin-top:5px;">(IdentitÃ¤t wechseln)</small>
        </div>

        <div id="nameInputContainer" style="margin-bottom: 20px;">
            <label style="font-size:0.9em; color:#aaa; margin-bottom:8px; display:block;">Codename / Nickname:</label>
            <input type="text" name="01_name" id="nameInput" required placeholder="z.B. Jonas_729">
        </div>

        <div style="margin-bottom: 40px;">
            <label style="font-size:0.9em; color:#aaa; margin-bottom:8px; display:block;">Deine Basis (Schule):</label>
            <select name="Schule" id="schoolInput" required>
                <option value="" disabled selected>WÃ¤hle deine Schule...</option>
                <option value="Goethe-Gymnasium">Goethe-Gymnasium</option>
                <option value="Leibniz-Realschule">Leibniz-Realschule</option>
                <option value="Stadtteilschule">Stadtteilschule</option>
                <option value="Andere">Andere</option>
            </select>
        </div>

        <div class="section-title">Block A: Gemischte Zahlen</div>
        <p style="color:#666; font-style:italic;">(Hier mÃ¼ssen deine Fragen aus dem alten Code wieder rein...)</p>


        <button type="submit" id="submitBtn">DATEN SENDEN ðŸš€</button>

    </form>
</div>

<script>
    // --- GEDÃ„CHTNIS ---
    const urlParams = new URLSearchParams(window.location.search);
    let user = urlParams.get('id') || localStorage.getItem('matheLigaUser');

    if (user) {
        localStorage.setItem('matheLigaUser', user);
        if(document.getElementById('nameInput')) document.getElementById('nameInput').value = user;
        if(document.getElementById('nameInputContainer')) document.getElementById('nameInputContainer').style.display = 'none';
        if(document.getElementById('displayName')) document.getElementById('displayName').innerText = user;
        if(document.getElementById('welcomeMessage')) document.getElementById('welcomeMessage').style.display = 'block';
    }

    function resetUser() {
        if(confirm("IdentitÃ¤t wirklich lÃ¶schen?")) {
            localStorage.removeItem('matheLigaUser');
            window.location.href = window.location.pathname; 
        }
    }

    // --- LOGIK ---
    const startTime = new Date();

    document.getElementById('quizForm').addEventListener('submit', function(e) {
        e.preventDefault(); 
        const btn = document.getElementById('submitBtn');
        btn.innerText = "Sende Paket...";
        btn.disabled = true;
        
        const name = document.getElementById('nameInput').value;
        const endTime = new Date();
        const seconds = Math.floor((endTime - startTime) / 1000);
        const durationString = Math.floor(seconds / 60) + "m " + (seconds % 60) + "s";

        const allRadios = document.querySelectorAll('input[type="radio"]:checked');
        let correct = 0;
        let details = "";
        
        allRadios.forEach(r => {
            if(r.value.includes('âœ…')) correct++;
            details += r.name + ": " + r.value + " | ";
        });
        
        // HIER FRAGENANZAHL ANPASSEN!
        const total = 25; 
        const scoreString = Math.round((correct / total) * 100) + "% (" + correct + "/" + total + ")";

        document.getElementById('scoreInput').value = scoreString;
        document.getElementById('durationInput').value = durationString;
        document.getElementById('rawInput').value = details;

        if(!user && name) {
            localStorage.setItem('matheLigaUser', name);
        }

        e.target.submit();
    });
</script>

</body>
</html>

