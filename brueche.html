<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mission: BrÃ¼che</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#121212">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <style>
        /* --- GAMING THEME COLORS --- */
        :root {
            --bg-dark: #121212;
            --card-bg: rgba(30, 30, 30, 0.95);
            --text-main: #ffffff;
            --accent: #3498db;  /* Challenger Blau */
            --success: #27ae60; /* Rookie GrÃ¼n */
        }

        body {
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            margin: 0; padding: 20px; color: var(--text-main);
            background-color: var(--bg-dark);
            padding-bottom: 100px;
            overflow-x: hidden;
        }

        /* --- HINTERGRUND ANIMATION (Geometrie) --- */
        .bg-animation {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1; overflow: hidden; pointer-events: none;
        }

        .shape {
            position: absolute; opacity: 0.15; filter: blur(8px);
            animation: float 25s infinite linear;
        }

        .s1 { top: 10%; left: 5%; width: 150px; height: 150px; background: var(--accent); border-radius: 20px; animation-duration: 35s; }
        .s2 { top: 70%; left: 80%; width: 200px; height: 200px; background: var(--success); border-radius: 50%; animation-delay: -5s; }
        .s3 { top: 40%; left: 60%; width: 100px; height: 100px; background: var(--accent); transform: rotate(45deg); animation-duration: 45s; animation-delay: -10s;}
        .s4 { top: 80%; left: 10%; width: 120px; height: 120px; border: 5px solid var(--success); animation-duration: 30s; animation-delay: -15s;}

        @keyframes float {
            0% { transform: translateY(0) rotate(0deg) scale(1); }
            50% { transform: translateY(-100px) rotate(180deg) scale(1.1); }
            100% { transform: translateY(0) rotate(360deg) scale(1); }
        }

        .container { max-width: 700px; margin: 0 auto; position: relative; z-index: 2; }

        /* HEADER */
        header { text-align: center; margin-bottom: 40px; }
        h1 { margin: 0; text-transform: uppercase; letter-spacing: 2px; font-size: 1.5em; color: var(--accent); text-shadow: 0 0 10px rgba(52, 152, 219, 0.3); }
        .subtitle { color: #888; font-size: 0.9em; margin-top: 5px; }

        /* BRUCH-DARSTELLUNG */
        .frac { display: inline-block; text-align: center; vertical-align: middle; position: relative; top: -5px; font-size: 0.9em; padding: 0 4px; }
        .frac .top { display: block; border-bottom: 1px solid rgba(255,255,255,0.7); padding: 0 2px; }
        .frac .bottom { display: block; padding: 0 2px; }
        .mixed { font-size: 1.2em; margin-right: 4px; font-weight: bold; }

        /* SEKTIONEN */
        .section-title { 
            margin-top: 50px; margin-bottom: 20px; 
            font-size: 1em; color: var(--accent); font-weight: bold; text-transform: uppercase; letter-spacing: 1px;
            border-bottom: 1px solid #333; padding-bottom: 5px;
        }

        /* FRAGEN-KARTEN */
        .question-block { 
            background: var(--card-bg); padding: 20px; border-radius: 15px; 
            margin-bottom: 25px; border: 1px solid #333; box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        .q-text { font-weight: 500; font-size: 1.1em; display: block; margin-bottom: 20px; }

        /* RADIO BUTTONS */
        .options-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; } 
        @media(max-width: 500px) { .options-grid { grid-template-columns: 1fr; } }

        .radio-label { 
            display: flex; align-items: center; padding: 15px; 
            background: #2a2a2a; border: 1px solid #444; border-radius: 10px; 
            cursor: pointer; transition: all 0.2s; 
        }
        .radio-label:hover { background: #333; border-color: var(--accent); }
        .radio-label:has(input:checked) { background: rgba(52, 152, 219, 0.2); border-color: var(--accent); }
        .radio-label input { margin-right: 12px; accent-color: var(--accent); transform: scale(1.2); }

        /* INPUTS */
        input[type="text"], select { 
            width: 100%; padding: 15px; background: #222; border: 1px solid #444; color: white;
            border-radius: 8px; font-size: 16px; box-sizing: border-box; 
        }
        input:focus { outline: none; border-color: var(--accent); }

        /* BUTTON */
        button { 
            display: block; width: 100%; padding: 20px; margin-top: 50px; 
            background: var(--success); color: white; border: none; border-radius: 12px; 
            font-size: 1.2em; font-weight: bold; cursor: pointer; 
            box-shadow: 0 0 20px rgba(39, 174, 96, 0.4); transition: transform 0.1s;
        }
        button:hover { background: #2ecc71; transform: scale(1.02); }
        button:active { transform: scale(0.98); }
        button:disabled { background: #555; box-shadow: none; cursor: wait; opacity: 0.7; }

    </style>
</head>
<body>

<div class="bg-animation">
    <div class="shape s1"></div>
    <div class="shape s2"></div>
    <div class="shape s3"></div>
    <div class="shape s4"></div>
</div>

<div class="container">
    <header>
        <h1>Mission: BrÃ¼che</h1>
        <div class="subtitle">Diagnose-Protokoll v1.2</div>
    </header>

    <form id="quizForm">
        
        <input type="hidden" name="00_SCORE" id="scoreInput" value="">
        <input type="hidden" name="00_DAUER" id="durationInput" value="">
        <input type="hidden" name="Rohdaten" id="rawInput" value="">
        <input type="hidden" name="Thema" value="Brueche_Terme">
        
        <div id="welcomeMessage" style="display:none; background:rgba(39, 174, 96, 0.2); color:#2ecc71; padding:15px; border-radius:10px; margin-bottom:25px; border: 1px solid #27ae60; text-align:center;">
            ðŸ‘‹ Pilot <strong id="displayName">...</strong> erkannt.
            <br><small onclick="resetUser()" style="cursor:pointer; text-decoration:underline; font-size:0.8em; color:#aaa; display:block; margin-top:5px;">(IdentitÃ¤t wechseln)</small>
        </div>

        <div id="nameInputContainer" style="margin-bottom: 20px;">
            <label style="font-size:0.9em; color:#aaa; margin-bottom:8px; display:block;">Codename / Nickname:</label>
            <input type="text" name="01_name" id="nameInput" required placeholder="z.B. Jonas_729">
        </div>

        <div style="margin-bottom: 40px;">
            <label style="font-size:0.9em; color:#aaa; margin-bottom:8px; display:block;">Deine Basis (Schule):</label>
            <select name="Schule" id="schoolInput" required>
                <option value="" disabled selected>WÃ¤hle deine Schule...</option>
                <option value="Goethe-Gymnasium">Goethe-Gymnasium</option>
                <option value="Leibniz-Realschule">Leibniz-Realschule</option>
                <option value="Stadtteilschule">Stadtteilschule</option>
                <option value="Andere">Andere</option>
            </select>
        </div>

        <div class="section-title">Block A: Gemischte Zahlen (5 Fragen)</div>
        <div class="question-block">
            <span class="q-text">1. Schreibe als unechten Bruch: <span class="mixed">2</span><div class="frac"><span class="top">1</span><span class="bottom">3</span></div></span>
            <div class="options-grid">
                <label class="radio-label"><input type="radio" name="A01" value="âœ… RICHTIG (7/3)" required> <div class="frac"><span class="top">7</span><span class="bottom">3</span></div></label>
                <label class="radio-label"><input type="radio" name="A01" value="âŒ FEHLER (2/3)"> <div class="frac"><span class="top">2</span><span class="bottom">3</span></div></label>
                <label class="radio-label"><input type="radio" name="A01" value="âŒ FEHLER (3/3)"> <div class="frac"><span class="top">3</span><span class="bottom">3</span></div></label>
                <label class="radio-label"><input type="radio" name="A01" value="âŒ FEHLER (5/3)"> <div class="frac"><span class="top">5</span><span class="bottom">3</span></div></label>
            </div>
        </div>

        <div class="question-block">
            <span class="q-text">2. Schreibe als gemischte Zahl: <div class="frac"><span class="top">13</span><span class="bottom">4</span></div></span>
            <div class="options-grid">
                <label class="radio-label"><input type="radio" name="A02" value="âŒ FEHLER (3 2/4)"> <span class="mixed">3</span><div class="frac"><span class="top">2</span><span class="bottom">4</span></div></label>
                <label class="radio-label"><input type="radio" name="A02" value="âœ… RICHTIG (3 1/4)"> <span class="mixed">3</span><div class="frac"><span class="top">1</span><span class="bottom">4</span></div></label>
                <label class="radio-label"><input type="radio" name="A02" value="âŒ FEHLER (4 1/4)"> <span class="mixed">4</span><div class="frac"><span class="top">1</span><span class="bottom">4</span></div></label>
                <label class="radio-label"><input type="radio" name="A02" value="âŒ FEHLER (1.3)"> 3,25</label>
            </div>
        </div>

        <div class="question-block">
            <span class="q-text">3. Erweitere <div class="frac"><span class="top">3</span><span class="bottom">5</span></div> mit 4:</span>
            <div class="options-grid">
                <label class="radio-label"><input type="radio" name="A03" value="âœ… RICHTIG (12/20)"> <div class="frac"><span class="top">12</span><span class="bottom">20</span></div></label>
                <label class="radio-label"><input type="radio" name="A03" value="âŒ FEHLER (Nur oben)"> <div class="frac"><span class="top">12</span><span class="bottom">5</span></div></label>
                <label class="radio-label"><input type="radio" name="A03" value="âŒ FEHLER (Addiert)"> <div class="frac"><span class="top">7</span><span class="bottom">9</span></div></label>
                <label class="radio-label"><input type="radio" name="A03" value="âŒ FEHLER (Falsch)"> <div class="frac"><span class="top">3</span><span class="bottom">20</span></div></label>
            </div>
        </div>

        <div class="question-block">
            <span class="q-text">4. KÃ¼rze vollstÃ¤ndig: <div class="frac"><span class="top">18</span><span class="bottom">24</span></div></span>
            <div class="options-grid">
                <label class="radio-label"><input type="radio" name="A04" value="âœ… RICHTIG (3/4)"> <div class="frac"><span class="top">3</span><span class="bottom">4</span></div></label>
                <label class="radio-label"><input type="radio" name="A04" value="âŒ FEHLER (Nicht ganz)"> <div class="frac"><span class="top">9</span><span class="bottom">12</span></div></label>
                <label class="radio-label"><input type="radio" name="A04" value="âŒ FEHLER (6/8)"> <div class="frac"><span class="top">6</span><span class="bottom">8</span></div></label>
                <label class="radio-label"><input type="radio" name="A04" value="âŒ FEHLER (2/3)"> <div class="frac"><span class="top">2</span><span class="bottom">3</span></div></label>
            </div>
        </div>

        <div class="question-block">
            <span class="q-text">5. Welche Zahl ist grÃ¶ÃŸer?</span>
            <div class="options-grid">
                <label class="radio-label"><input type="radio" name="A05" value="âœ… RICHTIG (2/3)"> <div class="frac"><span class="top">2</span><span class="bottom">3</span></div></label>
                <label class="radio-label"><input type="radio" name="A05" value="âŒ FEHLER (3/5)"> <div class="frac"><span class="top">3</span><span class="bottom">5</span></div></label>
                <label class="radio-label"><input type="radio" name="A05" value="âŒ FEHLER (Gleich)"> Beide gleich groÃŸ</label>
                <label class="radio-label"><input type="radio" name="A05" value="âŒ FEHLER (WeiÃŸ nicht)"> Kann man nicht sagen</label>
            </div>
        </div>

        <div class="section-title">Block B: Rechnen + & - (5 Fragen)</div>
        <div class="question-block">
            <span class="q-text">6. Berechne: <div class="frac"><span class="top">2</span><span class="bottom">7</span></div> + <div class="frac"><span class="top">3</span><span class="bottom">7</span></div></span>
            <div class="options-grid">
                <label class="radio-label"><input type="radio" name="B06" value="âœ… RICHTIG (5/7)"> <div class="frac"><span class="top">5</span><span class="bottom">7</span></div></label>
                <label class="radio-label"><input type="radio" name="B06" value="âŒ FEHLER (5/14)"> <div class="frac"><span class="top">5</span><span class="bottom">14</span></div></label>
                <label class="radio-label"><input type="radio" name="B06" value="âŒ FEHLER (6/7)"> <div class="frac"><span class="top">6</span><span class="bottom">7</span></div></label>
                <label class="radio-label"><input type="radio" name="B06" value="âŒ FEHLER (1)"> 1</label>
            </div>
        </div>

        <div class="question-block">
            <span class="q-text">7. Berechne: <div class="frac"><span class="top">1</span><span class="bottom">2</span></div> + <div class="frac"><span class="top">1</span><span class="bottom">4</span></div></span>
            <div class="options-grid">
                <label class="radio-label"><input type="radio" name="B07" value="âœ… RICHTIG (3/4)"> <div class="frac"><span class="top">3</span><span class="bottom">4</span></div></label>
                <label class="radio-label"><input type="radio" name="B07" value="âŒ FEHLER (2/6)"> <div class="frac"><span class="top">2</span><span class="bottom">6</span></div></label>
                <label class="radio-label"><input type="radio" name="B07" value="âŒ FEHLER (1/6)"> <div class="frac"><span class="top">1</span><span class="bottom">6</span></div></label>
                <label class="radio-label"><input type="radio" name="B07" value="âŒ FEHLER (2/4)"> <div class="frac"><span class="top">2</span><span class="bottom">4</span></div></label>
            </div>
        </div>

        <div class="question-block">
            <span class="q-text">8. Berechne: 1 - <div class="frac"><span class="top">2</span><span class="bottom">5</span></div></span>
            <div class="options-grid">
                <label class="radio-label"><input type="radio" name="B08" value="âœ… RICHTIG (3/5)"> <div class="frac"><span class="top">3</span><span class="bottom">5</span></div></label>
                <label class="radio-label"><input type="radio" name="B08" value="âŒ FEHLER (2/5)"> <div class="frac"><span class="top">2</span><span class="bottom">5</span></div></label>
                <label class="radio-label"><input type="radio" name="B08" value="âŒ FEHLER (1/5)"> <div class="frac"><span class="top">1</span><span class="bottom">5</span></div></label>
                <label class="radio-label"><input type="radio" name="B08" value="âŒ FEHLER (Minus)"> -<div class="frac"><span class="top">1</span><span class="bottom">5</span></div></label>
            </div>
        </div>

        <div class="question-block">
            <span class="q-text">9. Hauptnenner von 3 und 4?</span>
            <div class="options-grid">
                <label class="radio-label"><input type="radio" name="B09" value="âœ… RICHTIG (12)"> 12</label>
                <label class="radio-label"><input type="radio" name="B09" value="âŒ FEHLER (7)"> 7</label>
                <label class="radio-label"><input type="radio" name="B09" value="âŒ FEHLER (6)"> 6</label>
                <label class="radio-label"><input type="radio" name="B09" value="âŒ FEHLER (24)"> 24 (mÃ¶glich, aber nicht kleinster)</label>
            </div>
        </div>

        <div class="question-block">
            <span class="q-text">10. Berechne: <div class="frac"><span class="top">5</span><span class="bottom">6</span></div> - <div class="frac"><span class="top">1</span><span class="bottom">3</span></div></span>
            <div class="options-grid">
                <label class="radio-label"><input type="radio" name="B10" value="âœ… RICHTIG (1/2)"> <div class="frac"><span class="top">1</span><span class="bottom">2</span></div> (bzw. 3/6)</label>
                <label class="radio-label"><input type="radio" name="B10" value="âŒ FEHLER (4/3)"> <div class="frac"><span class="top">4</span><span class="bottom">3</span></div></label>
                <label class="radio-label"><input type="radio" name="B10" value="âŒ FEHLER (4/6)"> <div class="frac"><span class="top">4</span><span class="bottom">6</span></div></label>
                <label class="radio-label"><input type="radio" name="B10" value="âŒ FEHLER (4/9)"> <div class="frac"><span class="top">4</span><span class="bottom">9</span></div></label>
            </div>
        </div>

        <div class="section-title">Block C: Mal & Geteilt (5 Fragen)</div>
        <div class="question-block">
            <span class="q-text">11. Berechne: <div class="frac"><span class="top">2</span><span class="bottom">3</span></div> Â· <div class="frac"><span class="top">4</span><span class="bottom">5</span></div></span>
            <div class="options-grid">
                <label class="radio-label"><input type="radio" name="C11" value="âœ… RICHTIG (8/15)"> <div class="frac"><span class="top">8</span><span class="bottom">15</span></div></label>
                <label class="radio-label"><input type="radio" name="C11" value="âŒ FEHLER (6/8)"> <div class="frac"><span class="top">6</span><span class="bottom">8</span></div></label>
                <label class="radio-label"><input type="radio" name="C11" value="âŒ FEHLER (8/3)"> <div class="frac"><span class="top">8</span><span class="bottom">3</span></div></label>
                <label class="radio-label"><input type="radio" name="C11" value="âŒ FEHLER (24/15)"> <div class="frac"><span class="top">24</span><span class="bottom">15</span></div></label>
            </div>
        </div>

        <div class="question-block">
            <span class="q-text">12. Berechne: 3 Â· <div class="frac"><span class="top">2</span><span class="bottom">7</span></div></span>
            <div class="options-grid">
                <label class="radio-label"><input type="radio" name="C12" value="âœ… RICHTIG (6/7)"> <div class="frac"><span class="top">6</span><span class="bottom">7</span></div></label>
                <label class="radio-label"><input type="radio" name="C12" value="âŒ FEHLER (6/21)"> <div class="frac"><span class="top">6</span><span class="bottom">21</span></div></label>
                <label class="radio-label"><input type="radio" name="C12" value="âŒ FEHLER (5/7)"> <div class="frac"><span class="top">5</span><span class="bottom">7</span></div></label>
                <label class="radio-label"><input type="radio" name="C12" value="âŒ FEHLER (3 2/7)"> <span class="mixed">3</span><div class="frac"><span class="top">2</span><span class="bottom">7</span></div></label>
            </div>
        </div>

        <div class="question-block">
            <span class="q-text">13. Was ist der Kehrwert von <div class="frac"><span class="top">3</span><span class="bottom">4</span></div>?</span>
            <div class="options-grid">
                <label class="radio-label"><input type="radio" name="C13" value="âœ… RICHTIG (4/3)"> <div class="frac"><span class="top">4</span><span class="bottom">3</span></div></label>
                <label class="radio-label"><input type="radio" name="C13" value="âŒ FEHLER (-3/4)"> -<div class="frac"><span class="top">3</span><span class="bottom">4</span></div></label>
                <label class="radio-label"><input type="radio" name="C13" value="âŒ FEHLER (0.75)"> 0,75</label>
                <label class="radio-label"><input type="radio" name="C13" value="âŒ FEHLER (1)"> 1</label>
            </div>
        </div>

        <div class="question-block">
            <span class="q-text">14. Berechne: <div class="frac"><span class="top">1</span><span class="bottom">2</span></div> : <div class="frac"><span class="top">1</span><span class="bottom">3</span></div></span>
            <div class="options-grid">
                <label class="radio-label"><input type="radio" name="C14" value="âœ… RICHTIG (3/2)"> <div class="frac"><span class="top">3</span><span class="bottom">2</span></div></label>
                <label class="radio-label"><input type="radio" name="C14" value="âŒ FEHLER (1/6)"> <div class="frac"><span class="top">1</span><span class="bottom">6</span></div></label>
                <label class="radio-label"><input type="radio" name="C14" value="âŒ FEHLER (1)"> 1</label>
                <label class="radio-label"><input type="radio" name="C14" value="âŒ FEHLER (2/3)"> <div class="frac"><span class="top">2</span><span class="bottom">3</span></div></label>
            </div>
        </div>

        <div class="question-block">
            <span class="q-text">15. Berechne: <div class="frac"><span class="top">3</span><span class="bottom">4</span></div> von 20â‚¬</span>
            <div class="options-grid">
                <label class="radio-label"><input type="radio" name="C15" value="âœ… RICHTIG (15)"> 15â‚¬</label>
                <label class="radio-label"><input type="radio" name="C15" value="âŒ FEHLER (5)"> 5â‚¬</label>
                <label class="radio-label"><input type="radio" name="C15" value="âŒ FEHLER (12)"> 12â‚¬</label>
                <label class="radio-label"><input type="radio" name="C15" value="âŒ FEHLER (10)"> 10â‚¬</label>
            </div>
        </div>

        <div class="section-title">Block D: Dezimalzahlen (5 Fragen)</div>
        <div class="question-block">
            <span class="q-text">16. Schreibe 0,5 als Bruch:</span>
            <div class="options-grid">
                <label class="radio-label"><input type="radio" name="D16" value="âœ… RICHTIG (1/2)"> <div class="frac"><span class="top">1</span><span class="bottom">2</span></div></label>
                <label class="radio-label"><input type="radio" name="D16" value="âŒ FEHLER (1/5)"> <div class="frac"><span class="top">1</span><span class="bottom">5</span></div></label>
                <label class="radio-label"><input type="radio" name="D16" value="âŒ FEHLER (5/100)"> <div class="frac"><span class="top">5</span><span class="bottom">100</span></div></label>
                <label class="radio-label"><input type="radio" name="D16" value="âŒ FEHLER (5/1)"> <div class="frac"><span class="top">5</span><span class="bottom">1</span></div></label>
            </div>
        </div>

        <div class="question-block">
            <span class="q-text">17. Schreibe <div class="frac"><span class="top">1</span><span class="bottom">4</span></div> als Kommazahl:</span>
            <div class="options-grid">
                <label class="radio-label"><input type="radio" name="D17" value="âœ… RICHTIG (0.25)"> 0,25</label>
                <label class="radio-label"><input type="radio" name="D17" value="âŒ FEHLER (0.4)"> 0,4</label>
                <label class="radio-label"><input type="radio" name="D17" value="âŒ FEHLER (1.4)"> 1,4</label>
                <label class="radio-label"><input type="radio" name="D17" value="âŒ FEHLER (0.14)"> 0,14</label>
            </div>
        </div>

        <div class="question-block">
            <span class="q-text">18. Berechne: 0,3 + 0,07</span>
            <div class="options-grid">
                <label class="radio-label"><input type="radio" name="D18" value="âœ… RICHTIG (0.37)"> 0,37</label>
                <label class="radio-label"><input type="radio" name="D18" value="âŒ FEHLER (0.10)"> 0,10</label>
                <label class="radio-label"><input type="radio" name="D18" value="âŒ FEHLER (0.307)"> 0,307</label>
                <label class="radio-label"><input type="radio" name="D18" value="âŒ FEHLER (1)"> 1,0</label>
            </div>
        </div>

        <div class="question-block">
            <span class="q-text">19. Berechne: 2 Â· 0,4</span>
            <div class="options-grid">
                <label class="radio-label"><input type="radio" name="D19" value="âœ… RICHTIG (0.8)"> 0,8</label>
                <label class="radio-label"><input type="radio" name="D19" value="âŒ FEHLER (0.6)"> 0,6</label>
                <label class="radio-label"><input type="radio" name="D19" value="âŒ FEHLER (2.4)"> 2,4</label>
                <label class="radio-label"><input type="radio" name="D19" value="âŒ FEHLER (0.2)"> 0,2</label>
            </div>
        </div>

        <div class="question-block">
            <span class="q-text">20. Was ist grÃ¶ÃŸer? 0,1 oder 0,09?</span>
            <div class="options-grid">
                <label class="radio-label"><input type="radio" name="D20" value="âœ… RICHTIG (0.1)"> 0,1</label>
                <label class="radio-label"><input type="radio" name="D20" value="âŒ FEHLER (0.09)"> 0,09</label>
                <label class="radio-label"><input type="radio" name="D20" value="âŒ FEHLER (Gleich)"> Gleich groÃŸ</label>
                <label class="radio-label"><input type="radio" name="D20" value="âŒ FEHLER (WeiÃŸ nicht)"> WeiÃŸ nicht</label>
            </div>
        </div>

        <div class="section-title">Block E: Finale (5 Fragen)</div>
        <div class="question-block">
            <span class="q-text">21. Term: 2 + 3 Â· 4 = ?</span>
            <div class="options-grid">
                <label class="radio-label"><input type="radio" name="E21" value="âœ… RICHTIG (14)"> 14 (Punkt vor Strich)</label>
                <label class="radio-label"><input type="radio" name="E21" value="âŒ FEHLER (20)"> 20 (Von links nach rechts)</label>
                <label class="radio-label"><input type="radio" name="E21" value="âŒ FEHLER (9)"> 9</label>
                <label class="radio-label"><input type="radio" name="E21" value="âŒ FEHLER (24)"> 24</label>
            </div>
        </div>

        <div class="question-block">
            <span class="q-text">22. <div class="frac"><span class="top">1</span><span class="bottom">2</span></div> von einer halben Pizza ist...</span>
            <div class="options-grid">
                <label class="radio-label"><input type="radio" name="E22" value="âœ… RICHTIG (1/4)"> ein Viertel</label>
                <label class="radio-label"><input type="radio" name="E22" value="âŒ FEHLER (1)"> eine Ganze</label>
                <label class="radio-label"><input type="radio" name="E22" value="âŒ FEHLER (1/3)"> ein Drittel</label>
                <label class="radio-label"><input type="radio" name="E22" value="âŒ FEHLER (3/4)"> drei Viertel</label>
            </div>
        </div>

        <div class="question-block">
            <span class="q-text">23. Vereinfache: 4x + 2x</span>
            <div class="options-grid">
                <label class="radio-label"><input type="radio" name="E23" value="âœ… RICHTIG (6x)"> 6x</label>
                <label class="radio-label"><input type="radio" name="E23" value="âŒ FEHLER (6xÂ²)"> 6xÂ²</label>
                <label class="radio-label"><input type="radio" name="E23" value="âŒ FEHLER (8x)"> 8x</label>
                <label class="radio-label"><input type="radio" name="E23" value="âŒ FEHLER (6)"> 6</label>
            </div>
        </div>

        <div class="question-block">
            <span class="q-text">24. Welche Zahl fehlt? <div class="frac"><span class="top">2</span><span class="bottom">3</span></div> = <div class="frac"><span class="top">?</span><span class="bottom">9</span></div></span>
            <div class="options-grid">
                <label class="radio-label"><input type="radio" name="E24" value="âœ… RICHTIG (6)"> 6</label>
                <label class="radio-label"><input type="radio" name="E24" value="âŒ FEHLER (4)"> 4</label>
                <label class="radio-label"><input type="radio" name="E24" value="âŒ FEHLER (5)"> 5</label>
                <label class="radio-label"><input type="radio" name="E24" value="âŒ FEHLER (8)"> 8</label>
            </div>
        </div>

        <div class="question-block">
            <span class="q-text">25. Wenn 3 BrÃ¶tchen 1,50â‚¬ kosten, was kosten 5?</span>
            <div class="options-grid">
                <label class="radio-label"><input type="radio" name="E25" value="âœ… RICHTIG (2.50)"> 2,50â‚¬</label>
                <label class="radio-label"><input type="radio" name="E25" value="âŒ FEHLER (2.00)"> 2,00â‚¬</label>
                <label class="radio-label"><input type="radio" name="E25" value="âŒ FEHLER (3.00)"> 3,00â‚¬</label>
                <label class="radio-label"><input type="radio" name="E25" value="âŒ FEHLER (4.50)"> 4,50â‚¬</label>
            </div>
        </div>


        <button type="submit" id="submitBtn">DATEN SENDEN ðŸš€</button>

    </form>
</div>

<script>
    // --- 1. GEDÃ„CHTNIS (NAME & SCHULE) ---
    const urlParams = new URLSearchParams(window.location.search);
    let user = urlParams.get('id') || localStorage.getItem('matheLigaUser');
    let school = localStorage.getItem('matheLigaSchool');

    // UI Updates beim Laden
    if (user) {
        localStorage.setItem('matheLigaUser', user);
        // PrÃ¼fen ob Elemente existieren, um Fehler zu vermeiden
        const nameInput = document.getElementById('nameInput');
        const nameContainer = document.getElementById('nameInputContainer');
        const displayName = document.getElementById('displayName');
        const welcomeMsg = document.getElementById('welcomeMessage');

        if(nameInput) nameInput.value = user;
        if(nameContainer) nameContainer.style.display = 'none';
        if(displayName) displayName.innerText = user;
        if(welcomeMsg) welcomeMsg.style.display = 'block';
    }

    if (school) {
        const schoolField = document.getElementById('schoolInput');
        if (schoolField) schoolField.value = school;
    }

    function resetUser() {
        if(confirm("IdentitÃ¤t & Schule lÃ¶schen?")) {
            localStorage.removeItem('matheLigaUser');
            localStorage.removeItem('matheLigaSchool');
            window.location.href = window.location.pathname; 
        }
    }

    // --- 2. QUIZ LOGIK & SENDEN (ROBUST) ---
    const startTime = new Date();

    document.getElementById('quizForm').addEventListener('submit', async function(e) {
        e.preventDefault(); // Standard-Submit verhindern!

        const btn = document.getElementById('submitBtn');
        const originalText = btn.innerText;
        btn.innerText = "Sende Paket...";
        btn.disabled = true;
        btn.style.opacity = "0.7";
        
        // Daten sammeln
        const name = document.getElementById('nameInput').value;
        const currentSchool = document.getElementById('schoolInput').value;
        if(currentSchool) localStorage.setItem('matheLigaSchool', currentSchool);
        if(!user && name) localStorage.setItem('matheLigaUser', name);

        // Score berechnen
        const endTime = new Date();
        const seconds = Math.floor((endTime - startTime) / 1000);
        const durationString = Math.floor(seconds / 60) + "m " + (seconds % 60) + "s";

        const allRadios = document.querySelectorAll('input[type="radio"]:checked');
        let correct = 0;
        let details = "";
        
        allRadios.forEach(r => {
            if(r.value.includes('âœ…')) correct++;
            details += r.name + ": " + r.value + " | ";
        });
        
        const total = 25; 
        const scorePercentage = Math.round((correct / total) * 100);
        const scoreString = scorePercentage + "% (" + correct + "/" + total + ")";

        // Hidden Inputs fÃ¼llen
        document.getElementById('scoreInput').value = scoreString;
        document.getElementById('durationInput').value = durationString;
        document.getElementById('rawInput').value = details;

        // --- FETCH SENDEN ---
        const formData = new FormData(this); 
        // HINWEIS: Hier deine korrekte n8n Webhook URL eintragen!
        const webhookURL = "https://mathemeister9xklug.n8n.cloud/webhook/8b5a6681-d702-428b-9325-c9b803e69fba";

        try {
            // Wir warten maximal 3 Sekunden auf den Server, sonst leiten wir trotzdem weiter (Fail-Safe)
            const fetchPromise = fetch(webhookURL, {
                method: 'POST',
                body: formData
            });

            // Optional: Timeout Logik, falls n8n hÃ¤ngt
            const timeoutPromise = new Promise((_, reject) => 
                setTimeout(() => reject(new Error('Timeout')), 3000)
            );

            await Promise.race([fetchPromise, timeoutPromise]);
            console.log("Daten erfolgreich Ã¼bertragen.");

        } catch (error) {
            console.warn("Warnung: Datenversand dauerte zu lange oder schlug fehl. Leite trotzdem weiter.", error);
        }

        // --- WEITERLEITUNG ---
        // Egal ob Fetch geklappt hat oder nicht, der User darf nicht steckenbleiben.
        window.location.href = `danke.html?score=${scorePercentage}&time=${encodeURIComponent(durationString)}`;
    });
</script>
</body>
</html>


